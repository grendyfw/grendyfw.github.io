<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Will You Be My Valentine?</title>
<link rel="icon" href="favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

<style>
*, *::before, *::after { box-sizing: border-box; }

body {
  margin: 0;
  min-height: 100svh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #ffd6e8;
  font-family: "Comic Sans MS", cursive, sans-serif;
  overflow: hidden;
}

#page {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* CARD */
.card {
  background: white;
  padding: clamp(20px, 4vw, 30px);
  border-radius: 20px;
  text-align: center;
  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
  width: min(92vw, 380px);
  z-index: 2;
  animation: zoomIn 0.6s ease;
  position: relative;
}

@keyframes zoomIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

/* POP */
.card.pop { animation: cardPop 0.25s ease; }
@keyframes cardPop { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

.card.exit { animation: exit 0.6s forwards; }
@keyframes exit { to { opacity: 0; transform: scale(0.9); } }

img {
  width: 100%;
  max-width: 220px;
  margin-bottom: 15px;
  transition: transform 0.25s ease;
}

h1 { font-size: clamp(18px, 5vw, 22px); margin-bottom: 25px; }

/* BUTTONS */
.buttons { position: relative; width: 100%; height: 110px; }

button {
  padding: clamp(12px, 3.5vw, 16px) clamp(22px, 6vw, 30px);
  font-size: clamp(14px, 4vw, 17px);
  border: none;
  border-radius: 999px;
  cursor: pointer;
  position: absolute;
}

/* YES */
#yes { background: #ff4d6d; color: white; top: 50%; left: 50%; transform: translate(-110%, -50%); }
#yes:hover { transform: translate(-110%, -50%) scale(1.1); }

/* NO */
#no { background: #e0e0e0; color: #333; top: 50%; left: 50%; transform: translate(10%, -50%); }

.note { font-size: 12px; color: #888; margin-top: 15px; }

/* FINAL */
#final-wrapper {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 20px;
  z-index: 3;
}

#final-container {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
}

#final {
  max-width: 90vw;
  font-size: clamp(22px, 8vw, 56px);
  color: #ff4d6d;
  cursor: pointer;
  display: inline-block;
  opacity: 0;
  transition: opacity 0.6s ease, transform 0.25s ease;
}

#final.hoverable:hover { transform: scale(1.05); }

/* TYPEWRITER */
.typewriter { border-right: 4px solid #ff4d6d; padding-right: 6px; animation: blink 0.8s infinite; }
@keyframes blink { 0%,50% { border-color: transparent; } 51%,100% { border-color: #ff4d6d; } }

#final.fade-out { opacity: 0; }

/* FINAL IMAGE */
#final-image {
  max-width: 260px;
  width: 100%;
  opacity: 0;
  position: absolute;
  transition: opacity 3s ease, transform 0.25s ease;
  pointer-events: none;
}

#final-image.show { opacity: 1; }

#final-image:hover { transform: scale(1.05); }

/* BURST */
.burst { position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); pointer-events: none; animation: burst 700ms ease-out forwards; }
@keyframes burst { to { transform: translate(-50%, -50%) translate(var(--x), var(--y)) scale(0.3); opacity: 0; } }

/* PETALS */
.petal { position: fixed; top: -30px; pointer-events: none; z-index: 0; animation: fall linear forwards, sway ease-in-out infinite; }
@keyframes fall { to { transform: translateY(115vh); opacity: 0; } }
@keyframes sway { 0% { margin-left:0; } 50% { margin-left:20px; } 100% { margin-left:0; } }

/* HEARTS */
.heart { position: fixed; bottom: -20px; pointer-events: none; z-index: 1; animation: rise 6s linear forwards; }
@keyframes rise { to { transform: translateY(-110vh); opacity: 0; } }

/* CONFETTI */
.confetti { position: fixed; top: -20px; width: 10px; height: 14px; background: hsl(var(--hue), 80%, 60%); opacity: 0.9; pointer-events: none; z-index: 2; animation: confetti linear forwards; }
@keyframes confetti { to { transform: translateY(110vh) rotate(360deg); opacity: 0; } }

/* ENVELOPE */
#envelope {
  width: 140px;
  height: 90px;
  background: #DDA0DD; /* Light purple */
  margin: 25px auto 10px;
  position: relative;
  cursor: pointer;
  transition: transform 1.2s ease, opacity 2.5s ease; /* Added opacity transition */
  border-radius: 6px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  z-index: 1; /* Ensure it's above the image */
  opacity: 0; /* Start invisible */
}

#envelope:hover {
  transform: scale(1.15);
}

/* flap */
#envelope::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 0;
  height: 0;
  border-left: 70px solid transparent;
  border-right: 70px solid transparent;
  border-top: 45px solid #BA55D3; /* Medium purple for flap */
  transform-origin: top;
  transition: transform 0.5s ease;
}

/* open animation */
#envelope.open::before {
  transform: rotateX(180deg);
}

/* LETTER OVERLAY */
#letter-wrapper {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0,0,0,0.5); /* Transparent background */
  backdrop-filter: blur(6px);
  z-index: 999;
  animation: fadeIn 0.4s ease;
  overflow-y: auto;

}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

#letter {
  background: #fdf6e3;
  border: none;
  padding: 25px;
  max-width: 600px;
  width: 90%;
  max-height: 85vh;          /* âœ… prevents vertical expansion */
  overflow-y: auto;          /* âœ… allows scrolling inside letter */
  box-shadow: 0 10px 30px rgba(0,0,0,0.25);
  font-family: 'Times New Roman', serif;
  font-size: 16px;
  line-height: 1.6;
  position: relative;
  border-radius: 8px;
  animation: letterPop 0.4s ease;
}


@keyframes letterPop {
  from { transform: scale(0.8); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

/* close button */
#close-letter {
  position: absolute;
  top: 10px;
  right: 15px;
  font-size: 20px;
  cursor: pointer;
  color: #7c3aed;
}

</style>
</head>

<body>
<div id="page">
  <div class="card">
    <img src="couple.png">
    <h1>Angela, will you be my Valentine?</h1>
    <div class="buttons">
      <button id="yes">Yes</button>
      <button id="no">No</button>
    </div>
    <div class="note">*No seems a bit shy*</div>
  </div>
</div>

<audio id="pop" src="pop.mp3" preload="auto"></audio>

<script>
const noBtn = document.getElementById("no");
const yesBtn = document.getElementById("yes");
const buttons = document.querySelector(".buttons");
const card = document.querySelector(".card");
const page = document.getElementById("page");
const pop = document.getElementById("pop");

/* NO DODGE */
function moveNo() {
  const a = buttons.getBoundingClientRect();
  const b = noBtn.getBoundingClientRect();
  noBtn.style.left = Math.random() * (a.width - b.width) + "px";
  noBtn.style.top = Math.random() * (a.height - b.height) + "px";
}
noBtn.addEventListener("mouseover", moveNo);
noBtn.addEventListener("touchstart", e => { e.preventDefault(); moveNo(); });

/* PETALS */
let petals = setInterval(() => {
  const p = document.createElement("div");
  p.className = "petal";
  p.textContent = Math.random() > 0.5 ? "ðŸŒ¸" : "ðŸŒ¹";
  p.style.left = Math.random()*100 + "vw";
  p.style.fontSize = 16 + Math.random()*20 + "px";
  p.style.animation = `fall ${6+Math.random()*4}s linear forwards, sway ${3+Math.random()*2}s ease-in-out infinite`;
  document.body.appendChild(p);
  setTimeout(()=>p.remove(),10000);
},300);

/* BURST */
function popBurst() {
  card.classList.add("pop");
  setTimeout(()=>card.classList.remove("pop"),250);
  for(let i=0;i<24;i++){
    const b=document.createElement("div");
    b.className="burst";
    b.textContent=Math.random()>0.5?"ðŸ’–":"âœ¨";
    b.style.fontSize=14+Math.random()*18+"px";
    b.style.setProperty("--x",`${(Math.random()-0.5)*260}px`);
    b.style.setProperty("--y",`${(Math.random()-0.5)*260}px`);
    card.appendChild(b);
    setTimeout(()=>b.remove(),700);
  }
}

/* CONFETTI */
function launchConfetti(){
  for(let i=0;i<80;i++){
    const c=document.createElement("div");
    c.className="confetti";
    c.style.left=Math.random()*100 + "vw";
    c.style.animationDuration=3+Math.random()*3+"s";
    c.style.setProperty("--hue", Math.random()*360);
    document.body.appendChild(c);
    setTimeout(()=>c.remove(),6000);
  }
}

/* RESTART PETALS */
function restartPetals() {
  petals = setInterval(() => {
    const p = document.createElement("div");
    p.className = "petal";
    p.textContent = Math.random() > 0.5 ? "ðŸŒ¸" : "ðŸŒ¹";
    p.style.left = Math.random() * 100 + "vw";
    p.style.fontSize = 16 + Math.random() * 20 + "px";
    p.style.animation = `fall ${6+Math.random()*4}s linear forwards, sway ${3+Math.random()*2}s ease-in-out infinite`;
    document.body.appendChild(p);
    setTimeout(() => p.remove(), 10000);
  }, 300);
}


/* YES CLICK */
yesBtn.addEventListener("click", ()=> {
  clearInterval(petals);
  pop.play();
  popBurst();
  launchConfetti();

  setTimeout(()=>card.classList.add("exit"),250);

  let hearts = setInterval(()=>{
    const h = document.createElement("div");
    h.className = "heart";
    h.textContent="ðŸ’•";
    h.style.left=Math.random()*100 + "vw";
    h.style.fontSize=16+Math.random()*20+"px";
    document.body.appendChild(h);
    setTimeout(()=>h.remove(),6000);
  },300);

  setTimeout(()=>{
    page.innerHTML = `
      <div id="final-wrapper">
        <div id="final-container">
          <h1 id="final" class="typewriter"></h1>
          <img id="final-image"/>
        </div>
      </div>
    `;

    const messages = ["ðŸ’– YAY!!! BEST VALENTINE EVER ðŸ’–","ðŸŽµ It started from a song ðŸŽµ","ðŸŒ¸ Then we would get along ðŸŒ¸","â¤ï¸ I've been stealing glances at your tenderly smile â¤ï¸", "ðŸ’ž There's no girl as sweet as you ðŸ’ž", "ðŸ¥° You're so cute and pretty, you make my heart melt ðŸ¥°", "â˜Žï¸Your telephone number is my favorite placeâ˜Žï¸", "ðŸŒ¹ I could just look at you all night long ðŸŒ¹", "ðŸ’Œ If i have a favorite song it would be you ðŸ’Œ", "ðŸ’˜ Spending time with you is my desire ðŸ’˜"];
    const images = ["1.png","2.png","3.png","4.png","5.png","6.png","7.png","8.png","9.png","10.png"];
    let index = 0;

    const el = document.getElementById("final");
    const img = document.getElementById("final-image");

    function typeWriter(str, callback){
      el.textContent="";
      el.classList.add("typewriter");
      el.style.opacity=1;
      el.classList.remove("hoverable");
      let i=0;
      const t=setInterval(()=>{
        el.textContent+=str.charAt(i++);
        if(i===str.length){
          clearInterval(t);
          el.classList.remove("typewriter");
          el.classList.add("hoverable");
          if(callback) callback();
        }
      },120);
    }

    function showNext(){
      el.classList.remove("fade-out");
      el.style.opacity=1;
      img.classList.remove("show");
      img.style.opacity=0;
      img.style.pointerEvents = "none";

      typeWriter(messages[index], ()=>{

        el.onclick = ()=>{
          el.classList.add("fade-out");

          setTimeout(()=>{
            el.style.opacity=0;
            img.src = images[index];
            img.classList.add("show");
            img.style.opacity=0;

            setTimeout(()=>{ img.style.opacity=1; },50);

            img.addEventListener("transitionend", function enableClick(e){
              if(e.propertyName === "opacity"){
                img.style.pointerEvents = "auto";
                img.removeEventListener("transitionend", enableClick);
              }
            });

            img.onclick = ()=>{
              img.style.pointerEvents = "none";
              img.style.opacity = 0;

              img.addEventListener("transitionend", function afterFadeOut(e){
                if(e.propertyName === "opacity"){
                  img.classList.remove("show");
                  img.removeEventListener("transitionend", afterFadeOut);
                  index++;

                  if(index < messages.length){
                    showNext();
                  } else {

                    launchConfetti();
                    clearInterval(hearts);

                    petals = setInterval(()=>{
                      const p = document.createElement("div");
                      p.className="petal";
                      p.textContent = Math.random()>0.5 ? "ðŸŒ¸":"ðŸŒ¹";
                      p.style.left = Math.random()*100 + "vw";
                      p.style.fontSize = 16+Math.random()*20 + "px";
                      p.style.animation = `fall ${6+Math.random()*4}s linear forwards, sway ${3+Math.random()*2}s ease-in-out infinite`;
                      document.body.appendChild(p);
                      setTimeout(()=>p.remove(),10000);
                    },300);

                    const finalMessage = "ðŸ’– Happy Valentine's day, dear Angela ðŸ’–";

                    typeWriter(finalMessage, ()=>{

                      let clickStage = 0;
                      let clickLocked = false;

                      el.style.cursor = "pointer";

                      el.onclick = ()=>{

                        if(clickLocked) return;
                        clickLocked = true;
                        setTimeout(()=> clickLocked = false, 800);

                        // FIRST CLICK â†’ show envelope
                        if(clickStage === 0){

                          const container = document.getElementById("final-container");

                          const envelope = document.createElement("div");
                          envelope.id = "envelope";
                          container.appendChild(envelope);

                          const text = document.createElement("p");
                          text.textContent = "I wrote you a letter.";
                          text.style.fontSize = "16px";
                          text.style.color = "#333";
                          text.style.marginTop = "10px";
                          text.style.opacity = "0";
                          text.style.transition = "opacity 2.5s ease";
                          container.appendChild(text);

                          setTimeout(()=>{
                            envelope.style.opacity="1";
                            text.style.opacity="1";
                          },10);

                          envelope.addEventListener("click",(e)=>{
                            e.stopPropagation();
                            clearInterval(petals);
                            envelope.classList.add("open");

                            setTimeout(()=>{

                              const overlay = document.createElement("div");
                              overlay.id="letter-wrapper";

                              overlay.innerHTML=`
                                <div id="letter">
                                  <span id="close-letter">&times;</span>
                                  <p>Dear Angela,</p>
                                  <p>When I first saw you, I thought we're going to make songs together... me and you somewhere only us two.
                                  Then we get to know each other, sharing things we like, songs we like, anything we like...
                                  I noticed how you've been working hard to achive your own happiness and that amazed me really.
                                  Which somehow also makes me happy seeing you that happy.</p>
                                  At the same time you're also like a cupcake, you're so soft inside and flimsy outside (which makes want to hold your cheeks). 
                                  And cheeky little angel wants to play games she's so rude, always flirting, always joyful, always funny and always nice.</p>
                                
                                 <p>Angel, I love about you and everything you do. You managed to get into my heart just by being sweet to me. 
                                  I just want to let you know how awesome you are and you shouldn't be too hard on yourself, because i don't want to see you sick and hurting.
                                  Angela, not only you're so smart and knowledgable but you always gave your best on everything whether its your hobbies, painting, work, and other stuff.
                                  So, please be proud of yourself.</p>

                                  <p>And the moment i saw those smile of yours, you already makes me fall into you.
                                  Something about those lips of yours is soooo mesmerizing, I shall make it mine one day.
                                  You don't know how I'm so captivated by those brown eyes of yours. It makes me ran out of words, so please forgive me if sometimes I froze up when you're around, (also I bet you smell like summer <3).
                                  I think your parents didn't miss naming you Angela Putri Callista, because you are truly the most beautiful angel my eyes ever seen...</p>
                                  <p>Happy Valentine's Day,<br> dear Angela.</p>
                                  <p>Forever yours,<br>
                                  Tio</p>
                                </div>
                              `;

                              document.body.appendChild(overlay);

                              document.getElementById("close-letter").onclick=()=>{
                                overlay.remove();
                                envelope.classList.remove("open");
                                restartPetals();
                              };

                              overlay.addEventListener("click",(ev)=>{
                                if(ev.target===overlay){
                                  overlay.remove();
                                  envelope.classList.remove("open");
                                  restartPetals();
                                }
                              });

                            },500);
                          });

                          clickStage = 1;
                          return;
                        }

                        // SECOND CLICK â†’ reload
                        if(clickStage === 1){
                          location.reload();
                        }

                      };

                    });

                  }
                }
              });
            };

          },600);

        };

      });

    }

    showNext();

  },700);

});

</script>

</body>
</html> 
